{% extends 'hod_base.html' %}
{% load static %}

{% block title %}Manage Staff{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2>Manage Staff</h2>

    {% if staff_list %}
        <div class="table-responsive">
            <table class="table table-bordered align-middle">
                <thead class="table-light">
                    <tr>
                        <th>Email</th>
                        <th>Emp ID</th>
                        <th>Phone</th>
                        <th>Gender</th>
                        <th>Role</th>
                        <th>Campus</th>
                        <th>School</th>
                        <th>Department</th>
                        <th style="width: 160px;">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for staff in staff_list %}
                    <tr>
                        <form method="POST" action="{% url 'accounts:hod_update_staff' staff.id %}">
                            {% csrf_token %}
                            <td><input type="email" name="email" value="{{ staff.email }}" class="form-control form-control-sm"></td>
                            <td><input type="text" name="emp_id" value="{{ staff.emp_id|default:'' }}" class="form-control form-control-sm"></td>
                            <td><input type="text" name="phone_number" value="{{ staff.phone_number|default:'' }}" class="form-control form-control-sm"></td>
                            <td>
                                <select name="gender" class="form-select form-select-sm">
                                    <option value="" {% if not staff.gender %}selected{% endif %}>-</option>
                                    <option value="Male" {% if staff.gender == 'Male' %}selected{% endif %}>Male</option>
                                    <option value="Female" {% if staff.gender == 'Female' %}selected{% endif %}>Female</option>
                                    <option value="Other" {% if staff.gender == 'Other' %}selected{% endif %}>Other</option>
                                </select>
                            </td>
                            <td>
                                <input type="text" class="form-control form-control-sm" value="Staff" disabled>
                            </td>
                            <td>
                                <select name="campus" class="form-select form-select-sm">
                                    <option value="">-</option>
                                    {% for campus in campuses %}
                                        <option value="{{ campus.id }}" {% if staff.campus and staff.campus.id == campus.id %}selected{% endif %}>
                                            {{ campus.name }}
                                        </option>
                                    {% endfor %}
                                </select>
                            </td>
                            <td>
                                <select name="school" class="form-select form-select-sm">
                                    <option value="">-</option>
                                    {% for school in schools %}
                                        <option value="{{ school.id }}" {% if staff.school and staff.school.id == school.id %}selected{% endif %}>
                                            {{ school.name }}
                                        </option>
                                    {% endfor %}
                                </select>
                            </td>
                            <td>
                                <select name="department" class="form-select form-select-sm">
                                    <option value="">-</option>
                                    {% for dept in departments %}
                                        <option value="{{ dept.id }}" {% if staff.department and staff.department.id == dept.id %}selected{% endif %}>
                                            {{ dept.name }}
                                        </option>
                                    {% endfor %}
                                </select>
                            </td>
                            <td class="text-center">
                                <div class="d-flex gap-1 justify-content-center">
                                    <button type="submit" class="btn btn-success btn-sm px-3">Update</button>
                                    <a href="{% url 'accounts:hod_delete_staff' staff.id %}" class="btn btn-danger btn-sm px-3"
                                       onclick="return confirm('Are you sure you want to delete this staff?');">Delete</a>
                                </div>
                            </td>
                        </form>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% else %}
        <p>No staff members found.</p>
    {% endif %}

    <div class="mt-3">
        <a href="{% url 'accounts:hod_create_staff' %}" class="btn btn-primary">Add New Staff</a>
    </div>
</div>
{% endblock %}
